<!DOCTYPE html>
<!--[if IE 8]>
<html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en"> <!--<![endif]-->

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
 
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/foundation.css">
    <link rel="stylesheet" href="css/togglestyle.css">
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.css">
<link href="css/chatboxstyle.css" rel="stylesheet">
    <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
  
</head>

<body class="notconnected">

<div id="content" class="row">
<div id="connection">
<input type="hidden" value="broker.mqttdashboard.com" id="urlInput">
<input type="hidden" value="8000" id="portInput">
<input type="hidden" value="123" id="clientIdInput">
</div>

<input type="hidden" value="eeit89/101" id="publishTopic">
<input type="hidden" value="eeit89" id="publishTopicAll">
<input type="hidden" value="2" id="publishQoSInput">
<input type="hidden" value="王小明加入群聊" id="publishPayloadJoin">
<input type="hidden" value="王小明離開群聊" id="publishPayloadLeave">
    
<input type="hidden" value="green" id="colorChooser" >
<input type="hidden" value="2" id="QoSInput">
<input type="hidden" value="eeit89/101" id="subscribeTopic">
<input type="hidden" value="eeit89" id="subscribeTopic2">

<!-- 測試TOPIC -->
  <div class="columns large-4">

        <div class="large-8 columns subTop">
            <h3>Subscriptions</h3>
        </div>

            <div class="row panel">
                <div class="large-12 columns">
                   <ul id="innerEdit" class="disc">
                    </ul>
                </div>
            </div>
    </div>

</div>



<div class="chat_box" id="chat_box">

	<div class="chat_head">Chat Box
	<div id="connectionStatus"></div>
	</div>
	<div class="chat_body"> 
	<div class="user" id="aaa">王小明</div>
	
    <div class="user" id="bbb">群聊</div>

</div>
</div>


<div class="msg_box" style="right:290px" id="msg_box1">

	<div class="msg_head">王小明
	<div class="close">x</div>
	</div>
	<div class="msg_wrap">
		<div class="msg_body">
			<div id="messEdit1"></div>
		
			<div class="msg_push"></div>
		</div>
	<div class="msg_footer"><textarea class="msg_input" id="publishPayload1" rows="4"></textarea></div>
</div>
</div>


<div class="msg_box" style="right:550px" id="msg_box2">
	<div class="msg_head">群聊
	<div class="close">x</div>
	</div>
	<div class="msg_wrap">
		<div class="msg_body">
			<div id="messEdit2"></div>
		
			<div class="msg_push"></div>
		</div>
	<div class="msg_footer"><textarea class="msg_input" id="publishPayload2" rows="4"></textarea></div>
</div>
</div>




<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/lodash.js/1.3.1/lodash.min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.js"></script>

<script src="http://cdnjs.cloudflare.com/ajax/libs/foundation/4.2.3/js/foundation.min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/foundation/4.2.3/js/foundation/foundation.forms.min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/moment.js/2.1.0/moment.min.js"></script>
<script src="js/jquery.minicolors.min.js"></script>
<script src="js/mqttws31.js"></script>
<script src="js/encoder.js"></script>

<script src="js/app.js"></script>
 <script src="js/script.js"></script>
<script src="config.js"></script>

<script>

    function randomString(length) {
        var text = "";
        var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
        for (var i = 0; i < length; i++)
            text += possible.charAt(Math.floor(Math.random() * possible.length));
        return text;
    }

    $(document).foundation();
    $(document).ready(function () {

        $('#urlInput').val(websocketserver);
        $('#portInput').val(websocketport);
        $('#clientIdInput').val('clientId-' + randomString(10));

        $('#colorChooser').minicolors();

        $("#addSubButton").fancybox({
            'afterShow': function () {
                var rndColor = websocketclient.getRandomColor();
                $("#colorChooser").minicolors('value', rndColor);
            }
        });
        

        
        websocketclient.connect()
        
//        console.log(websocketclient.subscribe($('#subscribeTopic').val(),parseInt($('#QoSInput').val()),$('#colorChooser').val().substring(1)));
//         websocketclient.render.toggle('publish');
//         websocketclient.render.toggle('messages');
//          websocketclient.render.toggle('sub');
    });
</script>

</body>
</html>
